---
title: 'STAT 426: Project 1 Report'
author: "Spring 2021, by Shuyu Jia (shuyuj2)"
date: 'Due: Wednesday, Apr 14 by 11:59 PM'
output:
  pdf_document:
    toc: no
    toc_depth: 2
---

```{r setup, include=FALSE}
  knitr::opts_chunk$set(include = TRUE)  # TRUE for solution; FALSE for questions set
  knitr::opts_chunk$set(echo = TRUE)
  knitr::opts_chunk$set(message = FALSE)
  knitr::opts_chunk$set(warning = FALSE)
  knitr::opts_chunk$set(fig.height = 6, fig.width = 8, out.width = '100%', fig.align = "center")
  options(width = 90)
```

```{css, echo=FALSE}
.solution {
background-color: #CCDDFF;
}
```

# 1. Introduction

## 1.1 Background information

Ketorolac, sold under the brand name Toradol among others, is a nonsteroidal anti-inflammatory drug (NSAID) used for short-term management of moderate to severe pain. It is usually not prescribed for longer than five days on the grounds of its potential to cause kidney damage. It is used by mouth, by nose, by injection into a vein or muscle, and as eye drops. Effects begin within an hour and last for up to eight hours. There are common side effects and sometimes serious side effects, therefore during treatment with ketorolac, clinicians have to monitor for the manifestation of adverse effects. Some lab tests are often used to help identify potential complications.

## 1.2 Main objectives

There are two main objectives for this analysis. Firstly, we would like to know whether the use of Toradol decreases the probability of having a very long stay (more than five days) in the hospital after surgery. Secondly, we would like to know whether the use of Toradol is associated with a decreased chance of bad pain on the day after surgery. 

## 1.3 Other important predictors

However, there are other predictors that might affect the usage of Toradol. First of all, the use of Toradol increased over time. For example, more Toradol was used in 1998 than in 1996. During this time, the Health Maintenance Organizations (HMO's) were trying to set policies to get patients out of the hospital faster in the view that they could pay less money. In this case, the fact that the patients were getting out of the hospital faster can be explained by the time in addition to the Tordol usage. 

Furthermore, the distributions of some factors that might influence the length of stay can be differentfor Toradol users and non-Toradol users. Therefore, there are a lots of variables related to the status of the patients that can be conditioned on. These variables include the age of the patient. the duration of the surgery, the type of cancer the patient had, the stage of the cancer, radical hysterectomy, the degree of oophorectomy, lymph node sampling, whether additional surgical procedures were done in addition to the primary surgery, whether any complications took place during the surgery, etc.

# 2. Data

## 2.1 Data Summary

This dataset includes 147 women who underwent elective abdominal hysterectomies for cervical or uterine cancer on the gynecologic oncology service at the University of Wisconsin, between January 1996 and December 1998. The description of variables are as follows:

- `Pt.No` --- patient id number
- `DOS.yr` --- surgery year (nominal variable, 3 categories)
- `Age` --- age at surgery (continuous variable)
- `duration` --- duration of surgery (ordinal variable, 6 categories)
- `Diagnosis` --- cancer diagnosis (nominal variable, 3 categories)
- `Stage` --- how invasive the cancer is (ordinal variable, 11 categories)
- `General.diet` --- days until normal diet resumed (continuous variable)
- `BadPain` - whether average pain on a 1-10 scale was greater than 4 the day after surgery (binary variable)
- `LongStay` --- whether hospital stay was greater than 5 days after surgery (binary variable)
- `HYS` --- radical hysterectomy (binary variable)
- `OV` --- degree of oophorectomy in terms of surgical trauma (ordinal variable, 3 categories)
- `LNS` --- lymph node sampling in terms of surgical trauma (ordinal variable, 3 categories)
- `TOR` --- whether Toradol was used (binary variable)
- `AddPro ---` whether additional surgical procedures were done in addition to the surgery for primary cancer (binary variable)
- `Comps` --- whether any complications took place during the surgery (binary variable)
- `Morphine` --- total amount of morphine used while in hospital in milligrams (continuous variable)

```{r}
# load dataset
ketorolac = read.csv("ketorolac.csv")
# delete the first column
ketorolac = ketorolac[,-1]
# change surgery year and diagnosis into categorical variables
ketorolac$DOS.yr = as.factor(ketorolac$DOS.yr)
ketorolac$Diagnosis = as.factor(ketorolac$Diagnosis)
# change stage scaling into stage 1 to stage 4 instead of 11 sub-scales
stage_map = function(x){
  if((x>=1) & (x<=3)){
    return(1)
  } else if((x>=4) & (x<=5)){
    return(2)
  } else if((x>=6) & (x<=8)){
    return(3)
  } else if((x>=9) & (x<=11)){
    return(4)
  }
}
ketorolac$Stage = unlist(lapply(ketorolac$Stage, stage_map))
# summaries of the data
summary(ketorolac)
```

The summary information of all the variables are shown above. The first column shows patients ID number, which is irrelevant to the analysis, so we can simply remove it. The default data types for all variables is numerical. However, `DOS.yr` and `Diagnosis` are supposed to be nominal categorical variables, so we change both variables into factors. Moreover, we recategorize `Stage` variable into stage 1, stage 2, stage 3 and stage 4, which is more common than the 11 categories. We also notice that both `General.diet` and `BadPain` columns have missing values, and we will cope with them in the later sections.

Among all variables in the dataset, continuous variables include `Age`, `General.diet`, and `Morphine`; nominal categorical variables include `DOS.yr` and `Diagnosis`; ordinal categorical variables include `duration`, `Stage`, `OV` and `LNS`; binary variables include `BadPain`, `LongStay`, `HYS`, `TOR`, `AddPro`, and `Comps`, which only take values of 0 and 1. 

## 2.2 Outliers

For the three continuous variables, we would like to see whether there are outliers by making boxplots.

```{r}
par(mfrow=c(1,3))
boxplot(ketorolac[, "Age"], xlab = 'Age')
boxplot(ketorolac[, "General.diet"], xlab = 'General.diet')
boxplot(ketorolac[, "Morphine"], xlab = 'Morphine (mg)')
```

```{r}
which(ketorolac$Morphine > 250)
```

From the boxplot, we can see that there are three ourliers in the `Morphine` variable that is very far away from normal; they are observation number 3, 75 and 115. Previous studies found that the Toradol was assiciated with decreased morphine requirements and decreased post-operative pain. This is because morphine has a paralyzing effect on the digestive system, and decreasing morphine use might allow patients to resume a normal diet in less time, which might result in fewer days in the hospital folling surgery. Therefore, we should remove these 3 outliers due to the high morphine usage that might lead our analysis to a wrong direction.

```{r}
# delete outliers with high morphine usage
ketorolac = ketorolac[-c(3, 75, 115),]
```

## 2.3 Bivariate Analysis

```{r}
library(GGally)
ggcorr(ketorolac, label = TRUE)
```

From the correlation matrix, we can see that `BadPain` does not have a noticable correlation with any other variables. For the other variable of interest, `LongStay` has a moderately negative correlation with `TOR` (about -0.5), and a strong positive correlation with `General.diet` (about 0.7). In addition, we also find out that there is a strong positive correlation between `Age` and `OV` (about 0.6), and between `duration` and `HYS` (about 0.7). There is also a strong negative correlation between `Age` and `duration` (about -0.6), between `Age` and `HYS` (about -0.6), and betwwen `HYS` and `OV` (about -0.7).

# 3. Question One: Toradol and Long Stay

In this part, we would like to know whether the use of Toradol decreases the probability of having a very long stay (more than five days) in the hospital after surgery.

`General.diet` is more of an outcome variable than a predictor which more or less tells us how long did the patient get out of the hospital directly. Therefore it cannot be used to predict `LongStay`. Moreover, we should not use `Morphine` variable along with `TOR` because they are both used to ease the pain and Morphine usage is too related to Toradol usage. We also exclude the `BadPain` variable since it is the response for Question Two.

```{r}
# select relevant columns
ketorolac_Q1 = subset(ketorolac, select = -c(General.diet, BadPain, Morphine))
```

## 3.1 Odds-ratios

We begin by tabulating the odds-ratios for how each separate binary predictor (`HYS`, `TOR`, `AddPro`, `Comps`) is associated with a long hospital stay, and provide confidence intervals. We approach this by performing simple logistic regressions (one response variable and one predictor) for the response variable `LongStay`, so there will be a total of 4 models. Then we can take the exponential of the coefficients to get odds-ratios and the corresponding confidence intervals. The detailed codes can be found in the Appendix section 6.1. The tabulated results are as follows:

```{r}
# odds ratio and CI
data.frame(row.names = c("HYS", "TOR", "AddPro", "Comps"),
           odds_ratio = c(0.8788898, 0.1263858, 2.2121212, 5.400000),
           CI_lower = c(0.4298855, 0.058071, 0.9400848, 1.5654627),
           CI_upper = c(1.773212, 0.2632772, 5.3522599, 24.9463529))
```

Interpretations:

- According to the table above, patients with radical hysterectomy are 0.8788898 times less likely to stay in the hospital for more than 5 days after surgery. The 95% confidence interval for the odds-ratio is [0.4298855, 1.7732120].

- According to the table above, patients with the use of Toradol are 0.1263858 times less likely to stay in the hospital for more than 5 days after surgery. The 95% confidence interval for the odds-ratio is [0.0580710, 0.2632772].

- According to the table above, patients with additional surgical procedures are 2.2121212 times more likely to stay in the hospital for more than 5 days after surgery. The 95% confidence interval for the odds-ratio is [0.9400848, 5.3522599].

- According to the table above, patients with complications during surgery are 5.4000000 times more likely to stay in the hospital for more than 5 days after surgery. The 95% confidence interval for the odds-ratio is [1.5654627, 24.9463529].

We can see that the odds-ratio for `TOR` is less than 1, and the 95% confidence interval does not include 1, which statistically indicates that the use of Toradol decreases the probability of having a very long stay (more than 5 days).

## 3.2 Multiple logistic regression

Then we consider to use multiple logistic regression models including Toradol use and other predictors that might confound our interpretation of the effect of Toradol if omitted. In this analysis, we use the default logit link in all the models. We firstly build a full model with all the variables, then perform backward selection and choose the model with the lowest AIC score.

```{r}
# full model
full_mod_Q1 = glm(LongStay ~ ., family = binomial, data = ketorolac_Q1)
# backward selection with AIC
null_mod_Q1 = glm(LongStay ~ TOR, family = binomial, data = ketorolac_Q1)
back_mod_Q1 = step(full_mod_Q1, scope = list(upper = full_mod_Q1, lower = null_mod_Q1), 
                   direction = "backward", trace = 0, k = 2)
summary(back_mod_Q1)
```

Using backward selection, the best selected model uses 5 predictors (`DOS.yr`, `Age`, `duration`, `TOR`, `Comps`) with an AIC score of 154.39. We have also tried forward selection and get the same model as in the backward selection (see Appendix section 6.2 for detailed codes).

## 3.3 Model Diagnostics

First, let's perform the residual deviance test for the goodness of fit.

```{r}
# residual deviance test for the goodness of fit
pchisq(deviance(back_mod_Q1), df.residual(back_mod_Q1), lower.tail = FALSE)
```

The p-value for the residual deviance test is 0.403865, which is fairly large. This indicates that the response `LongStay` is predicted by the model pretty well. Next, we check for outliers by examining the standardized Pearson residuals.

```{r}
# check outliers
st_resid_Q1 = rstandard(back_mod_Q1, type="pearson")
(crit_val_Q1 = qt(0.05/2/nrow(ketorolac_Q1), df = df.residual(back_mod_Q1)-1, lower.tail = FALSE))
st_resid_Q1[abs(st_resid_Q1) > crit_val_Q1]
```

```{r}
plot(st_resid_Q1, xlab = "index", ylab = "Standardized Pearson Residuals", 
     col = ifelse(abs(st_resid_Q1) > crit_val_Q1, "red", "blue"), pch = 19)
```

We have used Bonferroni correction to calculate the adjusted critical value and use it to find outliers. As a result, no outliers are found. In addition, there is no trend for the residuals. Thus, it is fairly safe to say that the model is pretty decent. Lastly, we check for influential points by examining Cook's distances and Dfbetas.

```{r}
# Cook's distances
sum(cooks.distance(back_mod_Q1) > 1)
```

```{r}
# Dfbetas
colSums(dfbetas(back_mod_Q1) > 1)
```

Generally, an influential point has a Cook's distance greater than 1, or has a magnitude of Dfbeta larger than 1. From the results we can see that no infliential points are found using both metrics.

## 3.4 Interpretations

```{r}
final_mod_Q1 = back_mod_Q1
exp(final_mod_Q1$coefficients)
```

```{r, warning=FALSE, message=FALSE}
exp(confint(final_mod_Q1))
```

The interpretations of the estimates are as follows:

- If other variables remain the same, a patient who performed surgery in 1997 would on average be 0.3338876 times less likely to stay in the hospital for more than 5 days after surgery than a patient who performed surgery in 1996.

- If other variables remain the same, a patient who performed surgery in 1998 would on average be 0.1094407 times less likely to stay in the hospital for more than 5 days after surgery than a patient who performed surgery in 1996.

- If other variables remain the same, one additional age for a patient would increase her probability to stay in the hospital for more than 5 days after surgery by 1.0370135 times on average.

- If other variables remain the same, one additional increase in the scale of duration of surgery would increase the probability to stay in the hospital for more than 5 days after surgery by 1.4216879 times on average.

- If other variables remain the same, a patient with the use of Toradol would on average be 0.3404705 times less likely to stay in the hospital for more than 5 days after surgery than a patient without the use of Toraldol.

- If other variables remain the same, a patient with complications during surgery would on average be 5.5513285 times more likely to stay in the hospital for more than 5 days after surgery than a patient without any complications during surgery.

The confidence intervals for each coefficient is shown above. We can see that the coefficient for `TOR` is significant at the 0.05 significance level, which indicates that the use of Toradol is significant in terms of predicting the probability of having a very long stay (more than 5 days), so do the coefficients for `DOS.yr97`, `DOS.yr98`, `Age`, and `Comps`.

# 4. Question Two: Toradol and Bad Pain 

In this part, we would like to know whether the use of Toradol is associated with a decreased chance of bad pain on the day after surgery. 

Again, we should not use `Morphine` variable along with `TOR` because they are both used to ease the pain and Morphine usage is too related to Toradol usage. We also exclude the `LongStay` variable since it is the response for Question One.

```{r}
# select relevant columns
ketorolac_Q2 = subset(ketorolac, select = -c(LongStay, Morphine))
# delete missing data
ketorolac_Q2 = ketorolac_Q2[complete.cases(ketorolac_Q2),]
rownames(ketorolac_Q2) = NULL
```

## 4.1 Odds-ratios

We begin by tabulating the odds-ratios for how each separate binary predictor (`HYS`, `TOR`, `AddPro`, `Comps`) is associated with a bad pain, and provide confidence intervals. Again, we approach this by performing simple logistic regressions (one response variable and one predictor) for the response variable `BadPain`, so there will be a total of 4 models. Then we can calculate the exponential of the coefficients to get odds-ratios and the corresponding confidence intervals. The detailed codes can be found in the Appendix section 6.1. The tabulated results are as follows:

```{r}
# odds ratio and CI
data.frame(row.names = c("HYS", "TOR", "AddPro", "Comps"),
           odds_ratio = c(2.1037037, 0.8306011, 2.8205128, 0.5113636),
           CI_lower = c(0.9439759, 0.3789494, 1.0842937, 0.07646754),
           CI_upper = c(4.6903272, 1.8403917, 7.2292039, 2.0383882))
```

Interpretations:

- According to the table above, patients with radical hysterectomy are 2.1037037 times more likely to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery. The 95% confidence interval for the odds-ratio is [0.94397590, 4.690327].

- According to the table above, patients with the use of Toradol are 0.8306011 times less likely to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery. The 95% confidence interval for the odds-ratio is [0.37894940, 1.840392].

- According to the table above, patients with additional surgical procedures are 2.8205128 times more likely to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery. The 95% confidence interval for the odds-ratio is [1.08429370	, 7.229204].

- According to the table above, patients with complications during surgery are 0.5113636 times less likely to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery. The 95% confidence interval for the odds-ratio is [0.07646754, 2.038388].

We can see that although the odds-ratio for `TOR` is less than 1, the 95% confidence interval does include 1, which indicates that the use of Toradol is not significantly associated with a decreased chance of bad pain on the day after surgery.

## 4.2 Multiple logistic regression

Then we consider to use multiple logistic regression models including Toradol use and other predictors that might confound our interpretation of the effect of Toradol if omitted. In this analysis, we use the default logit link in all the models. We firstly build a full model with all the variables, then perform backward selection and choose the model with the lowest AIC score.

```{r}
# full model
full_mod_Q2 = glm(BadPain ~ ., family = binomial, data = ketorolac_Q2)
# backward selection with AIC
null_mod_Q2 = glm(BadPain ~ TOR, family = binomial, data = ketorolac_Q2)
back_mod_Q2 = step(full_mod_Q2, scope = list(upper = full_mod_Q2, lower = null_mod_Q2), 
                   direction = "backward", trace = 0, k = 2)
summary(back_mod_Q2)
```

Using backward selection, the best selected model uses 5 predictors (`Age`, `Diagnosis`, `TOR`, `AddPro`, `Comps`) with an AIC score of 140.45. We have also tried forward selection and get the same model as in the backward selection (see Appendix section 6.2 for detailed codes). Note that our variable of interest `TOR` is not significant at a significance level of 0.05, which indicates that `TOR` is not significant in terms of predicting a bad pain (greater than 4 on a 1-10 scale) the day after surgery.

## 4.3 Model Diagnostics

First, let's perform the residual deviance test for the goodness of fit.

```{r}
# residual deviance test for the goodness of fit
pchisq(deviance(back_mod_Q2), df.residual(back_mod_Q2), lower.tail = FALSE)
```

The p-value for the residual deviance test is 0.5221805, which is fairly large. This indicates that the response `BadPain` is predicted by the model pretty well. Next, we check for outliers by examining the standardized Pearson residuals.

```{r}
# check outliers
st_resid_Q2 = rstandard(back_mod_Q2, type="pearson")
(crit_val_Q2 = qt(0.05/2/nrow(ketorolac_Q2), df = df.residual(back_mod_Q2)-1, lower.tail = FALSE))
st_resid_Q2[abs(st_resid_Q2) > crit_val_Q2]
```

```{r}
plot(st_resid_Q2, xlab = "index", ylab = "Standardized Pearson Residuals", 
     col = ifelse(abs(st_resid_Q2) > crit_val_Q2, "red", "blue"), pch = 19)
```

We have used Bonferroni correction to calculate the adjusted critical value and use it to find outliers. As a result, we only find 2 outliers (observation 52 and 82). So we remove the outliers and update our model.

```{r}
final_mod_Q2 = glm(BadPain ~ Age + Diagnosis + TOR + AddPro + Comps, 
                   family = binomial, data = ketorolac_Q2[-c(52, 82),])
```

Lastly, we check for influential points by examining Cook's distances and Dfbetas.

```{r}
# Cook's distance
sum(cooks.distance(final_mod_Q2) > 1)
```

```{r}
# Dfbetas
colSums(dfbetas(final_mod_Q2) > 1)
```

Generally, an influential point has a Cook's distance greater than 1, or has a magnitude of Dfbeta larger than 1. From the results we can see that no infliential points are found using both metrics.

## 4.4 Interpretations

```{r}
exp(final_mod_Q2$coefficients)
```

```{r, warning=FALSE, message=FALSE}
exp(confint(final_mod_Q2))
```

The interpretations of the estimates are as follows:

- If other variables remain the same, one additional age for a patient would decrease her probability to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery by 0.9090738 times on average.

- If other variables remain the same, a patient with a diagnosis of endometrial cancer would on average be 0.9480915 times less likely to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery than a patient with a diagnosis of cervical cancer.

- If other variables remain the same, a patient with a diagnosis of uterine sarcoma would on average be 13.5117100 times more likely to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery than a patient with a diagnosis of cervical cancer.

- If other variables remain the same, a patient with the use of Toradol would on average be 0.4675420 times less likely to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery than a patient without the use of Toraldol.

- If other variables remain the same, a patient with additional surgical procedures would on average be 10.5560275 times more likely to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery than a patient without additional surgical procedures.

- If other variables remain the same, a patient with complications during surgery would on average be 0.2867527 times less likely to have a bad pain (greater than 4 on a 1-10 scale) the day after surgery than a patient without any complications during surgery.

The confidence intervals for each coefficient is shown above. We can see that the coefficients for `Age`, `Diagnosis3` and `AddPro` are significant at the significance level of 0.05. Although on average a patient with the use of Toradol would have less chance to have a bad pain, the confidence interval for the coefficient of `TOR` does includes 1, which indicates that `TOR` is not significant in terms of predicting a bad pain (greater than 4 on a 1-10 scale) the day after surgery.

# 5. Summary

## 5.1 Question One Summary

The use of Toradol is statistically significant to predict whether a patient has a very long stay (more than 5 days) in the hospital after surgery. Therefore, the use of Toradol can decrease the probability of having a very long stay (more than 5 days) in the hospital after surgery, statistically speaking. In addition, the best set of predictors to predict whether a patient has a very long stay (more than 5 days) in the hospital after surgery is surgery year, age, duration of surgery, whether Toradol is used, and whether any complications took place during surgery.

According to the best model, variables that are associated with a statistically significantly higher chance of long stay (more than 5 days) include:

- Surgery in year 1996
- High age
- Complications took place during surgery

According to the best model, variables that are associated with a statistically significantly lower chance of long stay (more than 5 days) include:

- Surgery in year 1997 or 1998, especially in 1998
- Use of Toradol

## 5.2 Question Two Summary

The use of Toradol is not statistically significant to predict whether a patient has a bad pain (more than 4 on a 1-10 scale) on the day after surgery. Therefore, the use of Toradol is not associated with a decreased chance of bad pain (more than 4 on a 1-10 scale) on the day after surgery, statistically speaking. In addition, the best set of predictors to predict whether a patient has a bad pain (more than 4 on a 1-10 scale) on the day after surgery is age, diagnosis, whether Toradol is used, whether additional surgical procedures were done, and whether any complications took place during surgery.

According to the best model, variables that are associated with a statistically significantly higher chance of bad pain (greater than 4 on a 1-10 scale) include:

- Diagnosed with uterine sarcoma
- Additional surgical procedures were done in addition to surgery for primary cancer

According to the best model, variables that are associated with a statistically significantly lower chance of bad pain (greater than 4 on a 1-10 scale) include:

- Diagnosed with cervical cancer or endometrial cancer
- High age

## 5.3 One Sentence Conclusion

Patients who used Toradol tended to do just as well with pain and got out of the hospital faster.

# 6. Appendix

## 6.1 Detailed codes for odds-ratios

```{r}
mod = glm(LongStay ~ HYS, data = ketorolac_Q1, family = binomial)
exp(mod$coefficients)
exp(confint(mod))
```

```{r}
mod = glm(LongStay ~ TOR, data = ketorolac_Q1, family = binomial)
exp(mod$coefficients)
exp(confint(mod))
```

```{r}
mod = glm(LongStay ~ AddPro, data = ketorolac_Q1, family = binomial)
exp(mod$coefficients)
exp(confint(mod))
```

```{r}
mod = glm(LongStay ~ Comps, data = ketorolac_Q1, family = binomial)
exp(mod$coefficients)
exp(confint(mod))
```

```{r}
mod = glm(BadPain ~ HYS, data = ketorolac_Q2, family = binomial)
exp(mod$coefficients)
exp(confint(mod))
```

```{r}
mod = glm(BadPain ~ TOR, data = ketorolac_Q2, family = binomial)
exp(mod$coefficients)
exp(confint(mod))
```

```{r}
mod = glm(BadPain ~ AddPro, data = ketorolac_Q2, family = binomial)
exp(mod$coefficients)
exp(confint(mod))
```

```{r}
mod = glm(BadPain ~ Comps, data = ketorolac_Q2, family = binomial)
exp(mod$coefficients)
exp(confint(mod))
```

## 6.2 Detailed codes of forward selection

```{r}
forw_mod_Q1 = step(null_mod_Q1, scope = list(upper = full_mod_Q1, lower = null_mod_Q1), 
                   direction = "forward", trace = 0)
forw_mod_Q1$aic
```

```{r}
forw_mod_Q2 = step(null_mod_Q2, scope = list(upper = full_mod_Q2, lower = null_mod_Q2), 
                   direction = "forward", trace = 0)
forw_mod_Q2$aic
```

## 6.3 Summaries for both final models

`LongStay` model:

```{r}
summary(final_mod_Q1)
```

`BadPain` model:

```{r}
summary(final_mod_Q2)
```

# 7. References

https://en.wikipedia.org/wiki/Ketorolac